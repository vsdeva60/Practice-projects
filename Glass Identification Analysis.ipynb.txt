{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c0ccf28f",
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "\n",
    "import os\n",
    "import json\n",
    "import time\n",
    "import pickle\n",
    "import requests\n",
    "\n",
    "\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "69964aa7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Id</th>\n",
       "      <th>RI</th>\n",
       "      <th>Na</th>\n",
       "      <th>Mg</th>\n",
       "      <th>Al</th>\n",
       "      <th>Si</th>\n",
       "      <th>K</th>\n",
       "      <th>Ca</th>\n",
       "      <th>Ba</th>\n",
       "      <th>Fe</th>\n",
       "      <th>Type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1.52101</td>\n",
       "      <td>13.64</td>\n",
       "      <td>4.49</td>\n",
       "      <td>1.10</td>\n",
       "      <td>71.78</td>\n",
       "      <td>0.06</td>\n",
       "      <td>8.75</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>1.51761</td>\n",
       "      <td>13.89</td>\n",
       "      <td>3.60</td>\n",
       "      <td>1.36</td>\n",
       "      <td>72.73</td>\n",
       "      <td>0.48</td>\n",
       "      <td>7.83</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>1.51618</td>\n",
       "      <td>13.53</td>\n",
       "      <td>3.55</td>\n",
       "      <td>1.54</td>\n",
       "      <td>72.99</td>\n",
       "      <td>0.39</td>\n",
       "      <td>7.78</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>1.51766</td>\n",
       "      <td>13.21</td>\n",
       "      <td>3.69</td>\n",
       "      <td>1.29</td>\n",
       "      <td>72.61</td>\n",
       "      <td>0.57</td>\n",
       "      <td>8.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>1.51742</td>\n",
       "      <td>13.27</td>\n",
       "      <td>3.62</td>\n",
       "      <td>1.24</td>\n",
       "      <td>73.08</td>\n",
       "      <td>0.55</td>\n",
       "      <td>8.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>209</th>\n",
       "      <td>210</td>\n",
       "      <td>1.51623</td>\n",
       "      <td>14.14</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.88</td>\n",
       "      <td>72.61</td>\n",
       "      <td>0.08</td>\n",
       "      <td>9.18</td>\n",
       "      <td>1.06</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>210</th>\n",
       "      <td>211</td>\n",
       "      <td>1.51685</td>\n",
       "      <td>14.92</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.99</td>\n",
       "      <td>73.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>8.40</td>\n",
       "      <td>1.59</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>211</th>\n",
       "      <td>212</td>\n",
       "      <td>1.52065</td>\n",
       "      <td>14.36</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.02</td>\n",
       "      <td>73.42</td>\n",
       "      <td>0.00</td>\n",
       "      <td>8.44</td>\n",
       "      <td>1.64</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>212</th>\n",
       "      <td>213</td>\n",
       "      <td>1.51651</td>\n",
       "      <td>14.38</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.94</td>\n",
       "      <td>73.61</td>\n",
       "      <td>0.00</td>\n",
       "      <td>8.48</td>\n",
       "      <td>1.57</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>213</th>\n",
       "      <td>214</td>\n",
       "      <td>1.51711</td>\n",
       "      <td>14.23</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.08</td>\n",
       "      <td>73.36</td>\n",
       "      <td>0.00</td>\n",
       "      <td>8.62</td>\n",
       "      <td>1.67</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>214 rows Ã— 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Id       RI     Na    Mg    Al     Si     K    Ca    Ba   Fe  Type\n",
       "0      1  1.52101  13.64  4.49  1.10  71.78  0.06  8.75  0.00  0.0     1\n",
       "1      2  1.51761  13.89  3.60  1.36  72.73  0.48  7.83  0.00  0.0     1\n",
       "2      3  1.51618  13.53  3.55  1.54  72.99  0.39  7.78  0.00  0.0     1\n",
       "3      4  1.51766  13.21  3.69  1.29  72.61  0.57  8.22  0.00  0.0     1\n",
       "4      5  1.51742  13.27  3.62  1.24  73.08  0.55  8.07  0.00  0.0     1\n",
       "..   ...      ...    ...   ...   ...    ...   ...   ...   ...  ...   ...\n",
       "209  210  1.51623  14.14  0.00  2.88  72.61  0.08  9.18  1.06  0.0     7\n",
       "210  211  1.51685  14.92  0.00  1.99  73.06  0.00  8.40  1.59  0.0     7\n",
       "211  212  1.52065  14.36  0.00  2.02  73.42  0.00  8.44  1.64  0.0     7\n",
       "212  213  1.51651  14.38  0.00  1.94  73.61  0.00  8.48  1.57  0.0     7\n",
       "213  214  1.51711  14.23  0.00  2.08  73.36  0.00  8.62  1.67  0.0     7\n",
       "\n",
       "[214 rows x 11 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv('glass.csv', names=[\"Id\",\"RI\",\"Na\",\"Mg\",\"Al\",\"Si\",\"K\",\"Ca\",\"Ba\",\"Fe\",\"Type\"])\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "f405e886",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Id      False\n",
      "RI      False\n",
      "Na      False\n",
      "Mg      False\n",
      "Al      False\n",
      "Si      False\n",
      "K       False\n",
      "Ca      False\n",
      "Ba      False\n",
      "Fe      False\n",
      "Type    False\n",
      "dtype: bool\n"
     ]
    }
   ],
   "source": [
    "# Checking for any missing data\n",
    "print(df.isnull().any())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6fdcdc33",
   "metadata": {},
   "source": [
    "### Pearson Correlation\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "9f3b4dd3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Type    1.000000\n",
       "Id      0.877357\n",
       "Al      0.598829\n",
       "Ba      0.575161\n",
       "Na      0.502898\n",
       "Si      0.151565\n",
       "Ca      0.000952\n",
       "K      -0.010054\n",
       "RI     -0.164237\n",
       "Fe     -0.188278\n",
       "Mg     -0.744993\n",
       "Name: Type, dtype: float64"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a = df.corr('pearson')\n",
    "a = a.loc['Type'].sort_values(ascending=False)\n",
    "a"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7b25be71",
   "metadata": {},
   "source": [
    "### Model Selection"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2afcd418",
   "metadata": {},
   "source": [
    "### Applying KNN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "0c249248",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Calculate Distance between any two given points\n",
    "def euclid_distance(train_point, given_point):\n",
    "    distance = np.sum((train_point-given_point)**2)\n",
    "    return np.sqrt(distance)\n",
    "\n",
    "\n",
    "# Calculate distance from a given point to all other points\n",
    "# and keep track of the respective classes for those distances\n",
    "# and eventually return sorted list of distances\n",
    "def calc_distance_from_all(all_points, given_point, predictions):\n",
    "    all_distances = []\n",
    "    for i, each in enumerate(all_points):\n",
    "        distance = euclid_distance(each, given_point)\n",
    "        all_distances.append((distance,int(predictions[i])))\n",
    "    all_distances.sort(key=lambda tup: tup[0])\n",
    "    return all_distances\n",
    "\n",
    "\n",
    "\n",
    "# Get the \"n\" defined neighbours from a list of sorted distances\n",
    "def get_neighbours(distances, count):\n",
    "    return distances[:count]\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "# Takes a given point and predicts the class based on all other points\n",
    "def predict(all_points, given_point, predictions):\n",
    "    distances = calc_distance_from_all(all_points,given_point,predictions)\n",
    "    neighbours = get_neighbours(distances, 5)\n",
    "    \n",
    "    op = [row[-1] for row in neighbours]\n",
    "    prediction = max(set(op), key=op.count)\n",
    "    return prediction\n",
    "\n",
    "\n",
    "\n",
    "# Get how accurate our system is based on a new set of test points\n",
    "# for which we already know the right answer to\n",
    "def accuracy(basex, basey, testx, testy):\n",
    "    correct = 0 \n",
    "    \n",
    "    for i in range(len(testx)):\n",
    "        p = predict(basex, testx[i], basey)\n",
    "        if p == testy[i]:\n",
    "            correct += 1\n",
    "            \n",
    "    return f\"Accuracy: {correct*100/len(testy)}%\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "b1f42e4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = df.drop(['Type'], axis = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "c4a1d156",
   "metadata": {},
   "outputs": [],
   "source": [
    "Y = df.Type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "de86c96b",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "c9d21681",
   "metadata": {},
   "outputs": [],
   "source": [
    "xtrain, xtest, ytrain, ytest = train_test_split(X,Y, test_size=0.3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "fcc05ec6",
   "metadata": {},
   "outputs": [],
   "source": [
    "f1 = 'Al'\n",
    "f2 = 'Mg'\n",
    "basex = np.array(xtrain[[f1, f2]])\n",
    "basey = np.array(ytrain)\n",
    "\n",
    "xtest = np.array(xtest[[f1, f2]])\n",
    "ytest = np.array(ytest)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "421cf1ee",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy: 66.15384615384616%\n"
     ]
    }
   ],
   "source": [
    "print(accuracy(basex,basey,xtest,ytest))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bd00f556",
   "metadata": {},
   "source": [
    "### Applying Neural Network"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "93a05ae7",
   "metadata": {},
   "outputs": [],
   "source": [
    "target = ['Type']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "7601402e",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = np.array(df.drop(target, axis = 1))\n",
    "Y = np.array(df['Type'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "279ba07f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: tensorflow in c:\\users\\anumy\\anaconda3\\lib\\site-packages (2.12.0)\n",
      "Requirement already satisfied: tensorflow-intel==2.12.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow) (2.12.0)\n",
      "Requirement already satisfied: termcolor>=1.1.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (2.3.0)\n",
      "Requirement already satisfied: tensorflow-estimator<2.13,>=2.12.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (2.12.0)\n",
      "Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (0.31.0)\n",
      "Requirement already satisfied: grpcio<2.0,>=1.24.3 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.54.2)\n",
      "Requirement already satisfied: six>=1.12.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.16.0)\n",
      "Requirement already satisfied: google-pasta>=0.1.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (0.2.0)\n",
      "Requirement already satisfied: tensorboard<2.13,>=2.12 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (2.12.3)\n",
      "Requirement already satisfied: astunparse>=1.6.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.6.3)\n",
      "Requirement already satisfied: jax>=0.3.15 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (0.4.11)\n",
      "Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (4.21.7)\n",
      "Requirement already satisfied: gast<=0.4.0,>=0.2.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (0.4.0)\n",
      "Requirement already satisfied: opt-einsum>=2.3.2 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (3.3.0)\n",
      "Requirement already satisfied: wrapt<1.15,>=1.11.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.12.1)\n",
      "Requirement already satisfied: numpy<1.24,>=1.22 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.22.4)\n",
      "Requirement already satisfied: absl-py>=1.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.4.0)\n",
      "Requirement already satisfied: setuptools in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (58.0.4)\n",
      "Requirement already satisfied: packaging in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (21.3)\n",
      "Requirement already satisfied: keras<2.13,>=2.12.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (2.12.0)\n",
      "Requirement already satisfied: typing-extensions>=3.6.6 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (3.10.0.2)\n",
      "Requirement already satisfied: flatbuffers>=2.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (23.5.26)\n",
      "Requirement already satisfied: libclang>=13.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (16.0.0)\n",
      "Requirement already satisfied: h5py>=2.9.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (3.2.1)\n",
      "Requirement already satisfied: wheel<1.0,>=0.23.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from astunparse>=1.6.0->tensorflow-intel==2.12.0->tensorflow) (0.37.0)\n",
      "Requirement already satisfied: importlib-metadata>=4.6 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from jax>=0.3.15->tensorflow-intel==2.12.0->tensorflow) (4.8.1)\n",
      "Requirement already satisfied: scipy>=1.7 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from jax>=0.3.15->tensorflow-intel==2.12.0->tensorflow) (1.7.1)\n",
      "Requirement already satisfied: ml-dtypes>=0.1.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from jax>=0.3.15->tensorflow-intel==2.12.0->tensorflow) (0.1.0)\n",
      "Requirement already satisfied: zipp>=0.5 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from importlib-metadata>=4.6->jax>=0.3.15->tensorflow-intel==2.12.0->tensorflow) (3.6.0)\n",
      "Requirement already satisfied: markdown>=2.6.8 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (3.3.7)\n",
      "Requirement already satisfied: werkzeug>=1.0.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2.0.2)\n",
      "Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (0.7.0)\n",
      "Requirement already satisfied: google-auth<3,>=1.6.3 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2.19.1)\n",
      "Requirement already satisfied: google-auth-oauthlib<1.1,>=0.5 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (1.0.0)\n",
      "Requirement already satisfied: requests<3,>=2.21.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2.26.0)\n",
      "Requirement already satisfied: pyasn1-modules>=0.2.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (0.3.0)\n",
      "Requirement already satisfied: rsa<5,>=3.1.4 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (4.9)\n",
      "Requirement already satisfied: urllib3<2.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (1.26.7)\n",
      "Requirement already satisfied: cachetools<6.0,>=2.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (5.3.1)\n",
      "Requirement already satisfied: requests-oauthlib>=0.7.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth-oauthlib<1.1,>=0.5->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (1.3.1)\n",
      "Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (0.5.0)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from requests<3,>=2.21.0->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2021.10.8)\n",
      "Requirement already satisfied: idna<4,>=2.5 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from requests<3,>=2.21.0->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (3.2)\n",
      "Requirement already satisfied: charset-normalizer~=2.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from requests<3,>=2.21.0->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2.0.4)\n",
      "Requirement already satisfied: oauthlib>=3.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<1.1,>=0.5->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (3.2.1)\n",
      "Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from packaging->tensorflow-intel==2.12.0->tensorflow) (3.0.4)\n"
     ]
    }
   ],
   "source": [
    "!pip install tensorflow"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "ceb71223",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: tensorflow in c:\\users\\anumy\\anaconda3\\lib\\site-packages (2.12.0)\n",
      "Requirement already satisfied: tensorflow-intel==2.12.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow) (2.12.0)\n",
      "Requirement already satisfied: gast<=0.4.0,>=0.2.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (0.4.0)\n",
      "Requirement already satisfied: setuptools in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (58.0.4)\n",
      "Requirement already satisfied: termcolor>=1.1.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (2.3.0)\n",
      "Requirement already satisfied: google-pasta>=0.1.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (0.2.0)\n",
      "Requirement already satisfied: grpcio<2.0,>=1.24.3 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.54.2)\n",
      "Requirement already satisfied: wrapt<1.15,>=1.11.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.12.1)\n",
      "Requirement already satisfied: typing-extensions>=3.6.6 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (3.10.0.2)\n",
      "Requirement already satisfied: tensorflow-estimator<2.13,>=2.12.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (2.12.0)\n",
      "Requirement already satisfied: libclang>=13.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (16.0.0)\n",
      "Requirement already satisfied: six>=1.12.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.16.0)\n",
      "Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (0.31.0)\n",
      "Requirement already satisfied: astunparse>=1.6.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.6.3)\n",
      "Requirement already satisfied: jax>=0.3.15 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (0.4.11)\n",
      "Requirement already satisfied: opt-einsum>=2.3.2 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (3.3.0)\n",
      "Requirement already satisfied: flatbuffers>=2.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (23.5.26)\n",
      "Requirement already satisfied: keras<2.13,>=2.12.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (2.12.0)\n",
      "Requirement already satisfied: packaging in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (21.3)\n",
      "Requirement already satisfied: numpy<1.24,>=1.22 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.22.4)\n",
      "Requirement already satisfied: tensorboard<2.13,>=2.12 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (2.12.3)\n",
      "Requirement already satisfied: absl-py>=1.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (1.4.0)\n",
      "Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (4.21.7)\n",
      "Requirement already satisfied: h5py>=2.9.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorflow-intel==2.12.0->tensorflow) (3.2.1)\n",
      "Requirement already satisfied: wheel<1.0,>=0.23.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from astunparse>=1.6.0->tensorflow-intel==2.12.0->tensorflow) (0.37.0)\n",
      "Requirement already satisfied: ml-dtypes>=0.1.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from jax>=0.3.15->tensorflow-intel==2.12.0->tensorflow) (0.1.0)\n",
      "Requirement already satisfied: importlib-metadata>=4.6 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from jax>=0.3.15->tensorflow-intel==2.12.0->tensorflow) (4.8.1)\n",
      "Requirement already satisfied: scipy>=1.7 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from jax>=0.3.15->tensorflow-intel==2.12.0->tensorflow) (1.7.1)\n",
      "Requirement already satisfied: zipp>=0.5 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from importlib-metadata>=4.6->jax>=0.3.15->tensorflow-intel==2.12.0->tensorflow) (3.6.0)\n",
      "Requirement already satisfied: google-auth<3,>=1.6.3 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2.19.1)\n",
      "Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (0.7.0)\n",
      "Requirement already satisfied: markdown>=2.6.8 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (3.3.7)\n",
      "Requirement already satisfied: requests<3,>=2.21.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2.26.0)\n",
      "Requirement already satisfied: google-auth-oauthlib<1.1,>=0.5 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (1.0.0)\n",
      "Requirement already satisfied: werkzeug>=1.0.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2.0.2)\n",
      "Requirement already satisfied: cachetools<6.0,>=2.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (5.3.1)\n",
      "Requirement already satisfied: pyasn1-modules>=0.2.1 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (0.3.0)\n",
      "Requirement already satisfied: rsa<5,>=3.1.4 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (4.9)\n",
      "Requirement already satisfied: urllib3<2.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (1.26.7)\n",
      "Requirement already satisfied: requests-oauthlib>=0.7.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from google-auth-oauthlib<1.1,>=0.5->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (1.3.1)\n",
      "Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (0.5.0)\n",
      "Requirement already satisfied: charset-normalizer~=2.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from requests<3,>=2.21.0->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2.0.4)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from requests<3,>=2.21.0->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (2021.10.8)\n",
      "Requirement already satisfied: idna<4,>=2.5 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from requests<3,>=2.21.0->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (3.2)\n",
      "Requirement already satisfied: oauthlib>=3.0.0 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<1.1,>=0.5->tensorboard<2.13,>=2.12->tensorflow-intel==2.12.0->tensorflow) (3.2.1)\n",
      "Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in c:\\users\\anumy\\anaconda3\\lib\\site-packages (from packaging->tensorflow-intel==2.12.0->tensorflow) (3.0.4)\n"
     ]
    }
   ],
   "source": [
    "!pip install --upgrade tensorflow"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "23b15dc2",
   "metadata": {},
   "outputs": [],
   "source": [
    "import tensorflow as tf\n",
    "from sklearn.model_selection import train_test_split\n",
    "from tensorflow.python import keras"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "3594f2e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "model = tf.keras.Sequential([\n",
    "    keras.layers.Dense(25, input_shape=(X[0].shape), activation=tf.nn.tanh),\n",
    "    keras.layers.Dense(13, activation=tf.nn.tanh),\n",
    "    keras.layers.Dense(8, activation=tf.nn.softmax)\n",
    "])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "f6fc89dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "xtrain, xtest, ytrain, ytest = train_test_split(X,Y, test_size=0.2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "c7d8141b",
   "metadata": {},
   "outputs": [],
   "source": [
    "from tensorflow.keras.optimizers import Adam"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "090630f5",
   "metadata": {},
   "outputs": [],
   "source": [
    "model.compile(loss='sparse_categorical_crossentropy',\n",
    "              optimizer=Adam(0.00001),\n",
    "              metrics=['accuracy'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "43530dbf",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/10\n",
      "5/5 - 1s - loss: 2.9710 - accuracy: 0.0441 - val_loss: 2.9558 - val_accuracy: 0.0286 - 693ms/epoch - 139ms/step\n",
      "Epoch 2/10\n",
      "5/5 - 0s - loss: 2.9677 - accuracy: 0.0441 - val_loss: 2.9526 - val_accuracy: 0.0286 - 30ms/epoch - 6ms/step\n",
      "Epoch 3/10\n",
      "5/5 - 0s - loss: 2.9644 - accuracy: 0.0441 - val_loss: 2.9494 - val_accuracy: 0.0286 - 27ms/epoch - 5ms/step\n",
      "Epoch 4/10\n",
      "5/5 - 0s - loss: 2.9612 - accuracy: 0.0441 - val_loss: 2.9462 - val_accuracy: 0.0286 - 28ms/epoch - 6ms/step\n",
      "Epoch 5/10\n",
      "5/5 - 0s - loss: 2.9579 - accuracy: 0.0441 - val_loss: 2.9431 - val_accuracy: 0.0286 - 29ms/epoch - 6ms/step\n",
      "Epoch 6/10\n",
      "5/5 - 0s - loss: 2.9547 - accuracy: 0.0441 - val_loss: 2.9400 - val_accuracy: 0.0286 - 30ms/epoch - 6ms/step\n",
      "Epoch 7/10\n",
      "5/5 - 0s - loss: 2.9515 - accuracy: 0.0441 - val_loss: 2.9369 - val_accuracy: 0.0286 - 27ms/epoch - 5ms/step\n",
      "Epoch 8/10\n",
      "5/5 - 0s - loss: 2.9484 - accuracy: 0.0441 - val_loss: 2.9338 - val_accuracy: 0.0286 - 31ms/epoch - 6ms/step\n",
      "Epoch 9/10\n",
      "5/5 - 0s - loss: 2.9451 - accuracy: 0.0441 - val_loss: 2.9307 - val_accuracy: 0.0286 - 32ms/epoch - 6ms/step\n",
      "Epoch 10/10\n",
      "5/5 - 0s - loss: 2.9419 - accuracy: 0.0441 - val_loss: 2.9276 - val_accuracy: 0.0286 - 30ms/epoch - 6ms/step\n"
     ]
    }
   ],
   "source": [
    "history = model.fit(xtrain, ytrain, epochs=10, validation_split=0.2, verbose=2)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "47c974c7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x23bff9ab5b0>]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(history.epoch, history.history['loss'], 'g')\n",
    "plt.plot(history.epoch, history.history['val_loss'],'r')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "a9b6e651",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2/2 [==============================] - 0s 4ms/step - loss: 2.8251 - accuracy: 0.0465\n"
     ]
    }
   ],
   "source": [
    "loss, accuracy = model.evaluate(xtest,ytest)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "e9ccb82e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "4.651162773370743\n"
     ]
    }
   ],
   "source": [
    "print(accuracy*100)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "11dfff15",
   "metadata": {},
   "source": [
    "### Applying KNN using sklearn"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "bd220466",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.neighbors import KNeighborsClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "6d4efe37",
   "metadata": {},
   "outputs": [],
   "source": [
    "neighbors = np.arange(1,10)\n",
    "train_accuracy =np.empty(len(neighbors))\n",
    "test_accuracy = np.empty(len(neighbors))\n",
    "\n",
    "for i,k in enumerate(neighbors):\n",
    "    #Setup a knn classifier with k neighbors\n",
    "    knn = KNeighborsClassifier(n_neighbors=k)\n",
    "    \n",
    "    #Fit the model\n",
    "    knn.fit(xtrain, ytrain.ravel())\n",
    "    \n",
    "    #Compute accuracy on the training set\n",
    "    train_accuracy[i] = knn.score(xtrain, ytrain.ravel())\n",
    "    \n",
    "    #Compute accuracy on the test set\n",
    "    test_accuracy[i] = knn.score(xtest, ytest.ravel())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "dafafad5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"â–¸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"â–¾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>KNeighborsClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier()</pre></div></div></div></div></div>"
      ],
      "text/plain": [
       "KNeighborsClassifier()"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classifier = KNeighborsClassifier(n_neighbors=5)  \n",
    "classifier.fit(xtrain, ytrain.ravel())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "046e4b77",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 7, 1, 3, 1, 1, 2, 7, 2, 2, 1, 3, 1, 5, 1, 2, 3, 2, 7, 2, 6, 1,\n",
       "       6, 1, 2, 1, 1, 2, 1, 2, 1, 7, 2, 1, 5, 1, 2, 2, 1, 7, 2, 1, 7],\n",
       "      dtype=int64)"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_pred = classifier.predict(xtest)\n",
    "y_pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "049b0ae4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[17  0  0  0  0  0]\n",
      " [ 0 13  0  0  0  0]\n",
      " [ 0  0  3  0  0  0]\n",
      " [ 0  0  0  2  0  0]\n",
      " [ 0  0  0  0  2  0]\n",
      " [ 0  0  0  0  0  6]]\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "           1       1.00      1.00      1.00        17\n",
      "           2       1.00      1.00      1.00        13\n",
      "           3       1.00      1.00      1.00         3\n",
      "           5       1.00      1.00      1.00         2\n",
      "           6       1.00      1.00      1.00         2\n",
      "           7       1.00      1.00      1.00         6\n",
      "\n",
      "    accuracy                           1.00        43\n",
      "   macro avg       1.00      1.00      1.00        43\n",
      "weighted avg       1.00      1.00      1.00        43\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import classification_report, confusion_matrix  \n",
    "print(confusion_matrix(ytest, y_pred))  \n",
    "print(classification_report(ytest, y_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "897e69db",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
